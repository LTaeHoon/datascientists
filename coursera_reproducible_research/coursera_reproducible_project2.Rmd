#The effects of severe weather events on the population health and economic

## Synopsis 
this analysis is for prepareing to prevent the population health from severe weather events. the goal of this analysis is to explore the storm data from NOAA Storm Database and explore the effects of severe weather events on both population health and economic.

the data be used in this analysis are covered from year 1950 and 2011 Nov.In the earlier years of the database there are generally fewer events recorded, most likely due to a lack of good records. More recent years should be considered more complete.

Finally, this analysis aim to investigate which types of events are most harmful on population health and what types of events have caused the greatest economic consequences across the united states. To achieve this purpose, We will explore related data to answer below question.

## Questions

1. Across the United States, which types of events (as indicated in the EVTYPE variable) most harmful with respect to population health?
2. Across the United States, which types of events have the greatest economic consequences?

## Data processing
The data can be downloaded from the course website:[StormData](https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2).
There is also some documentation of the database available. Here you will find how some of the variables are constructed/defined.
- National Weather Service [Storm Data Documentation](https://d396qusza40orc.cloudfront.net/repdata%2Fpeer2_doc%2Fpd01016005curr.pdf)
- National Climatic Data Center Storm Events [FAQ](https://d396qusza40orc.cloudfront.net/repdata%2Fpeer2_doc%2FNCDC%20Storm%20Events-FAQ%20Page.pdf)

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

the following packages will be required.
```{r}
library(dplyr)
library(ggplot2)
library(stringr)
```
The first step is to read the data. you should set working directory you work now.
```{r cache=TRUE}
setwd("E:/github/datascientist/coursera_reproducible_research")
storm_data <- read.csv("repdata-data-StormData.csv",stringsAsFactors = FALSE)
```

Subsetting the needed column for analysis.
```{r}
storm_data_sub <- storm_data[,c("EVTYPE","FATALITIES","INJURIES","PROPDMG","PROPDMGEXP","CROPDMG","CROPDMGEXP")]
head(storm_data_sub)
```
- Population health
first of all, I have prepared the data for fatalities and injuries.
```{r}
fatalities <- aggregate(storm_data_sub$FATALITIES,by=list(storm_data_sub$EVTYPE),sum)
names(fatalities)<- c("EVTYPE","fatalities")
fatalities <- fatalities[order(fatalities$fatalities,decreasing = T),]
injuries <- aggregate(storm_data_sub$INJURIES,by=list(storm_data_sub$EVTYPE),sum)
names(injuries)<- c("EVTYPE","injuries")
injuries <- injuries[order(injuries$injuries,decreasing = T),]
```

Second, i also have prepared the data for Economic consequences.
Since the exponential value like propdmgexp, cropdmgexp has stored by letters(h = hundred, k = thousand, m = million, b = billion),  so that should be converted to number.
for this, i have created a related function.
```{r}
exp <- function(e){
  if(e %in% c("h","H"))
    return(2)
  else if(e %in% c("k","K"))
    return(3)
  else if(e %in% c("m","M"))
    return(6)
  else if(e %in% c("b","B"))
    return(9)
  else if(!is.na(as.numeric(e)))
    return(suppressWarnings(as.numeric(e)))
  else if(e %in% c("?","","+","-"))
    return(0)
  else{
    stop("invalid value")
  }
}
```

i have created new column(propdmg, cropdmg) using the exp function.
```{r}
proexp <- sapply(storm_data_sub$PROPDMGEXP,FUN=exp)
storm_data_sub$propdamage<-storm_data_sub$PROPDMG*(10**proexp)
cropexp <- sapply(storm_data_sub$CROPDMGEXP,FUN=exp)
storm_data_sub$cropdamage<-storm_data_sub$CROPDMG*(10**cropexp)
```

## Result





## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
